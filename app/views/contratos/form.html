{% extends "layout.html" %}
{% block title %}{{ 'Editar' if contract else 'Novo' }} contrato | SaaS Contratos{% endblock %}

{% block content %}
<div class="flex items-center justify-between">
  <div>
    <p class="text-sm uppercase tracking-[0.2em] text-slate-400">Contratos</p>
    <h1 class="text-3xl font-semibold text-white">{{ 'Editar' if contract else 'Novo' }} contrato</h1>
  </div>
  <a href="{{ url_for('contracts.list_contracts') }}" class="text-sm font-semibold text-slate-200 hover:text-white">Voltar</a>
</div>

<form method="POST" class="mt-6 space-y-5 rounded-2xl border border-white/10 bg-white/5 px-6 py-6 shadow-xl shadow-black/30">
  <div class="grid gap-5 md:grid-cols-2">
    <div>
      <label class="block text-sm text-slate-300">Título</label>
      <input name="title" required value="{{ contract.title if contract else '' }}" class="mt-2 w-full rounded-xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-slate-500 focus:border-glow focus:outline-none" placeholder="Contrato de prestação de serviços" />
    </div>
    <div>
      <label class="block text-sm text-slate-300">Valor (R$)</label>
      <input name="value" required value="{{ '%.2f'|format(contract.value) if contract else '' }}" class="mt-2 w-full rounded-xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-slate-500 focus:border-glow focus:outline-none" placeholder="1500.00" />
    </div>
    <div>
      <label class="block text-sm text-slate-300">Contratante</label>
      <input name="client_name" required value="{{ contract.client_name if contract else '' }}" class="mt-2 w-full rounded-xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-slate-500 focus:border-glow focus:outline-none" placeholder="Cliente" />
    </div>
    <div>
      <label class="block text-sm text-slate-300">Contratado</label>
      <input name="provider_name" required value="{{ contract.provider_name if contract else '' }}" class="mt-2 w-full rounded-xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-slate-500 focus:border-glow focus:outline-none" placeholder="Prestador de serviço" />
    </div>
    <div>
      <label class="block text-sm text-slate-300">Forma de pagamento</label>
      <input name="payment_terms" required value="{{ contract.payment_terms if contract else '' }}" class="mt-2 w-full rounded-xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-slate-500 focus:border-glow focus:outline-none" placeholder="30 dias, 50% entrada, etc." />
    </div>
    <div>
      <label class="block text-sm text-slate-300">Cidade</label>
      <input name="city" required value="{{ contract.city if contract else '' }}" class="mt-2 w-full rounded-xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-slate-500 focus:border-glow focus:outline-none" placeholder="São Paulo" />
    </div>
    <div>
      <label class="block text-sm text-slate-300">Data de vencimento</label>
      <input name="due_date" type="date" value="{{ contract.due_date.isoformat() if contract and contract.due_date else '' }}" class="mt-2 w-full rounded-xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-slate-500 focus:border-glow focus:outline-none" />
    </div>
    <div>
      <label class="block text-sm text-slate-300">Status</label>
      <select name="status" class="mt-2 w-full rounded-xl border border-white/10 bg-white/10 px-4 py-3 text-white focus:border-glow focus:outline-none">
        {% set current_status = contract.status if contract else 'rascunho' %}
        {% for value, label in [('rascunho', 'Rascunho'), ('assinado', 'Assinado'), ('cancelado', 'Cancelado')] %}
          <option value="{{ value }}" {% if current_status == value %}selected{% endif %}>{{ label }}</option>
        {% endfor %}
      </select>
    </div>
  </div>

  <div>
    <label class="block text-sm text-slate-300">Descrição do serviço</label>
    <textarea name="service_description" required rows="4" class="mt-2 w-full rounded-xl border border-white/10 bg-white/10 px-4 py-3 text-white placeholder:text-slate-500 focus:border-glow focus:outline-none" placeholder="Detalhe o escopo do serviço, entregas, prazos, etc.">{{ contract.service_description if contract else '' }}</textarea>
  </div>

  <div class="flex justify-end">
    <button type="submit" class="rounded-xl bg-gradient-to-r from-glow via-cyan-400 to-accent px-5 py-3 text-sm font-semibold text-night shadow-lg shadow-cyan-500/30 transition hover:brightness-105">
      Salvar contrato
    </button>
  </div>
</form>
{% endblock %}
